(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{JjdP:function(e,t,n){"use strict";n.r(t);var r=n("HaE+"),a=n("o0o1"),o=n.n(a),c=n("LtsZ");t["default"]={"dfs-demo":{component:Object(c["dynamic"])({loader:function(){var e=Object(r["a"])(o.a.mark((function e(){var t,r,a,c,l,u,i,s,d;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=n("TqRt"),e.t0=r,e.next=4,n.e(5).then(n.bind(null,"1OyB"));case 4:return e.t1=e.sent,a=(0,e.t0)(e.t1),e.t2=r,e.next=9,n.e(6).then(n.bind(null,"vuIU"));case 9:return e.t3=e.sent,c=(0,e.t2)(e.t3),e.t4=r,e.next=14,n.e(7).then(n.bind(null,"Ji7U"));case 14:return e.t5=e.sent,l=(0,e.t4)(e.t5),e.t6=r,e.next=19,n.e(4).then(n.bind(null,"LK+K"));case 19:return e.t7=e.sent,u=(0,e.t6)(e.t7),i=function(e){(0,l["default"])(r,e);var n=(0,u["default"])(r);function r(){return(0,a["default"])(this,r),n.apply(this,arguments)}return(0,c["default"])(r,[{key:"render",value:function(){return t.createElement("div",{className:"app"},t.createElement("header",null,"header"),t.createElement(s,null),t.createElement("footer",null,"footer"))}}]),r}(t.Component),s=function(e){(0,l["default"])(r,e);var n=(0,u["default"])(r);function r(){return(0,a["default"])(this,r),n.apply(this,arguments)}return(0,c["default"])(r,[{key:"render",value:function(){return t.createElement(t.Fragment,null,t.createElement("p",null,"1"),t.createElement("p",null,"2"),t.createElement("p",null,"3"))}}]),r}(t.Component),d=i,e.abrupt("return",d);case 25:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:'class App extends React.Component {\n  render() {\n    return (\n      <div className="app">\n        <header>header</header>\n        <Content />\n        <footer>footer</footer>\n      </div>\n    );\n  }\n}\n\nclass Content extends React.Component {\n  render() {\n    return (\n      <React.Fragment>\n        <p>1</p>\n        <p>2</p>\n        <p>3</p>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default App;'}},dependencies:{},identifier:"dfs-demo"}},"01-setstate-demo":{component:Object(c["dynamic"])({loader:function(){var e=Object(r["a"])(o.a.mark((function e(){var t,r,a,c,l,u,i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n("TqRt"),e.t0=t,e.next=4,n.e(5).then(n.bind(null,"1OyB"));case 4:return e.t1=e.sent,r=(0,e.t0)(e.t1),e.t2=t,e.next=9,n.e(6).then(n.bind(null,"vuIU"));case 9:return e.t3=e.sent,a=(0,e.t2)(e.t3),e.t4=t,e.next=14,n.e(7).then(n.bind(null,"Ji7U"));case 14:return e.t5=e.sent,c=(0,e.t4)(e.t5),e.t6=t,e.next=19,n.e(4).then(n.bind(null,"LK+K"));case 19:return e.t7=e.sent,l=(0,e.t6)(e.t7),e.t8=t,e.next=24,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 24:return e.t9=e.sent,u=(0,e.t8)(e.t9),i=function(e){(0,c["default"])(n,e);var t=(0,l["default"])(n);function n(){var e;(0,r["default"])(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),e.state={count:0},e.changeState=function(){var t=e.state.count+1;e.setState({count:e.state.count+1}),t===e.state.count?console.log("\u540c\u6b65\u6267\u884crender"):console.log("\u5f02\u6b65\u6267\u884crender")},e.changeState2=function(){var t=e.state.count+1;Promise.resolve().then((function(){e.setState({count:e.state.count+1}),t===e.state.count?console.log("\u540c\u6b65\u6267\u884crender"):console.log("\u5f02\u6b65\u6267\u884crender")}))},e}return(0,a["default"])(n,[{key:"render",value:function(){return u["default"].createElement("div",null,u["default"].createElement("p",null,"\u5f53\u524dcount=",this.state.count),u["default"].createElement("button",{onClick:this.changeState},"\u5f02\u6b65+1"),u["default"].createElement("button",{onClick:this.changeState2},"\u540c\u6b65+1"))}}]),n}(u["default"].Component),e.abrupt("return",i);case 28:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React from 'react';\n\nexport default class App extends React.Component {\n  state = {\n    count: 0,\n  };\n\n  changeState = () => {\n    const newCount = this.state.count + 1;\n    this.setState({\n      count: this.state.count + 1,\n    });\n    if (newCount === this.state.count) {\n      console.log('\u540c\u6b65\u6267\u884crender');\n    } else {\n      console.log('\u5f02\u6b65\u6267\u884crender');\n    }\n  };\n\n  changeState2 = () => {\n    const newCount = this.state.count + 1;\n    Promise.resolve().then(() => {\n      this.setState({\n        count: this.state.count + 1,\n      });\n      if (newCount === this.state.count) {\n        console.log('\u540c\u6b65\u6267\u884crender');\n      } else {\n        console.log('\u5f02\u6b65\u6267\u884crender');\n      }\n    });\n  };\n\n  render() {\n    return (\n      <div>\n        <p>\u5f53\u524dcount={this.state.count}</p>\n        <button onClick={this.changeState}>\u5f02\u6b65+1</button>\n        <button onClick={this.changeState2}>\u540c\u6b65+1</button>\n      </div>\n    );\n  }\n}"}},dependencies:{react:{version:"17.0.2"}},identifier:"01-setstate-demo"}},"hook-state-demo":{component:Object(c["dynamic"])({loader:function(){var e=Object(r["a"])(o.a.mark((function e(){var t,r,a,c,l,u;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=function(){var e=(0,a.useState)(0),t=(0,r["default"])(e,2),n=t[0],o=t[1];return a["default"].createElement("button",{onClick:function(){o(1),o(3),o(2)}},n)},l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r["default"]=e,n&&n.set(e,r),r},c=function(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)},t=n("TqRt"),e.t0=t,e.next=7,n.e(3).then(n.bind(null,"ODXe"));case 7:return e.t1=e.sent,r=(0,e.t0)(e.t1),e.t2=l,e.next=12,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 12:return e.t3=e.sent,a=(0,e.t2)(e.t3),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React, { useState } from 'react';\nexport default function App() {\n  const [count, dispatch] = useState(0);\n  return (\n    <button\n      onClick={() => {\n        dispatch(1);\n        dispatch(3);\n        dispatch(2);\n      }}\n    >\n      {count}\n    </button>\n  );\n}"}},dependencies:{react:{version:"17.0.2"}},identifier:"hook-state-demo"}},"hook-summary-demo":{component:Object(c["dynamic"])({loader:function(){var e=Object(r["a"])(o.a.mark((function e(){var t,r,a,c,l,u;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=function(){var e=(0,a.useState)(1),t=(0,r["default"])(e,2),n=t[0],o=t[1];(0,a.useEffect)((function(){console.log("effect 1 created")}));var c=(0,a.useState)(2),l=(0,r["default"])(c,1),u=l[0];return(0,a.useEffect)((function(){console.log("effect 2 created")})),a["default"].createElement(a["default"].Fragment,null,a["default"].createElement("button",{onClick:function(){return o(n+1)}},n),a["default"].createElement("button",null,u))},l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r["default"]=e,n&&n.set(e,r),r},c=function(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)},t=n("TqRt"),e.t0=t,e.next=7,n.e(3).then(n.bind(null,"ODXe"));case 7:return e.t1=e.sent,r=(0,e.t0)(e.t1),e.t2=l,e.next=12,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 12:return e.t3=e.sent,a=(0,e.t2)(e.t3),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React, { useState, useEffect } from 'react';\nexport default function App() {\n  // 1. useState\n  const [a, setA] = useState(1);\n  // 2. useEffect\n  useEffect(() => {\n    console.log(`effect 1 created`);\n  });\n  // 3. useState\n  const [b] = useState(2);\n  // 4. useEffect\n  useEffect(() => {\n    console.log(`effect 2 created`);\n  });\n  return (\n    <>\n      <button onClick={() => setA(a + 1)}>{a}</button>\n      <button>{b}</button>\n    </>\n  );\n}"}},dependencies:{react:{version:"17.0.2"}},identifier:"hook-summary-demo"}},"hook-demo":{component:Object(c["dynamic"])({loader:function(){var e=Object(r["a"])(o.a.mark((function e(){var t,r,a,c,l,u,i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=function(){Promise.resolve().then((function(){console.log("\u6240\u6709\u7684effect.create\u90fd\u662f\u901a\u8fc7\u8c03\u5ea6\u5668(scheduler)\u5f02\u6b65(MessageChannel)\u6267\u884c\u7684, \u6545effect.create\u51fd\u6570\u5fc5\u7136\u5728\u6b64\u4e4b\u540e\u6267\u884c")}));var e=(0,a.useState)(0),t=(0,r["default"])(e,2),n=t[0],o=t[1];return(0,a.useEffect)((function(){return console.log("\u7b2c1\u4e2aeffect.create dps: []"),function(){console.log("\u7b2c1\u4e2aeffect.destory")}}),[]),(0,a.useEffect)((function(){return console.log("effect.create dps: [count]",n),function(){console.log("\u7b2c2\u4e2aeffect.destory dps: [count]",n)}}),[n]),a["default"].createElement(a["default"].Fragment,null,a["default"].createElement("p",null,"You clicked ",n," times"),a["default"].createElement("button",{onClick:function(){return o(n+1)}},"Click me"))},l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r["default"]=e,n&&n.set(e,r),r},c=function(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)},t=n("TqRt"),e.t0=t,e.next=7,n.e(3).then(n.bind(null,"ODXe"));case 7:return e.t1=e.sent,r=(0,e.t0)(e.t1),e.t2=l,e.next=12,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 12:return e.t3=e.sent,a=(0,e.t2)(e.t3),i=u,e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React, { useState, useEffect } from 'react';\nfunction Example() {\n  Promise.resolve().then(() => {\n    console.log(\n      '\u6240\u6709\u7684effect.create\u90fd\u662f\u901a\u8fc7\u8c03\u5ea6\u5668(scheduler)\u5f02\u6b65(MessageChannel)\u6267\u884c\u7684, \u6545effect.create\u51fd\u6570\u5fc5\u7136\u5728\u6b64\u4e4b\u540e\u6267\u884c',\n    );\n  });\n  // \u7b2c1\u4e2ahook(useState)\n  const [count, setCount] = useState(0);\n  // \u7b2c2\u4e2ahook(useEffect)\n  useEffect(() => {\n    console.log('\u7b2c1\u4e2aeffect.create dps: []');\n    return () => {\n      console.log('\u7b2c1\u4e2aeffect.destory');\n    };\n  }, []);\n  // \u7b2c3\u4e2ahook(useEffect)\n  useEffect(() => {\n    console.log('effect.create dps: [count]', count);\n    return () => {\n      console.log('\u7b2c2\u4e2aeffect.destory dps: [count]', count);\n    };\n  }, [count]);\n  return (\n    <>\n      <p>You clicked {count} times</p>\n      <button onClick={() => setCount(count + 1)}>Click me</button>\n    </>\n  );\n}\nexport default Example;"}},dependencies:{react:{version:"17.0.2"}},identifier:"hook-demo"}}}},MZF8:function(e,t,n){"use strict";var r=n("ogwx");n.d(t,"a",(function(){return r["b"]}));n("VCU9")},Zs1V:function(e){e.exports=JSON.parse("{}")},v9v0:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),o=n("dEAq"),c=n("Zxc8"),l=n("H1Ra"),u=n("JjdP"),i=a.a.memo(u["default"]["01-setstate-demo"].component);t["default"]=e=>(a.a.useEffect((()=>{var t;null!==e&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&t.hash&&o["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),a.a.createElement(a.a.Fragment,null,a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"markdown"},a.a.createElement("h1",{id:"react-\u4e2d-setstate-\u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65"},a.a.createElement(o["AnchorLink"],{to:"#react-\u4e2d-setstate-\u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"React \u4e2d, setState \u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65"),a.a.createElement("p",null,"\u6240\u8c13\u540c\u6b65\u8fd8\u662f\u5f02\u6b65\u6307\u7684\u662f\u8c03\u7528 setState \u4e4b\u540e\u662f\u5426\u9a6c\u4e0a\u80fd\u5f97\u5230\u6700\u65b0\u7684 state"),a.a.createElement("p",null,"\u4e0d\u4ec5\u4ec5\u662f",a.a.createElement("code",null,"setState"),"\u4e86, \u5728\u5bf9 function \u7c7b\u578b\u7ec4\u4ef6\u4e2d\u7684 hook \u8fdb\u884c\u64cd\u4f5c\u65f6\u4e5f\u662f\u4e00\u6837, \u6700\u7ec8\u51b3\u5b9a",a.a.createElement("code",null,"setState"),"\u662f\u540c\u6b65\u6e32\u67d3\u8fd8\u662f\u5f02\u6b65\u6e32\u67d3\u7684\u5173\u952e\u56e0\u7d20\u662f",a.a.createElement("code",null,"ReactFiberWorkLoop"),"\u5de5\u4f5c\u7a7a\u95f4\u7684\u6267\u884c\u4e0a\u4e0b\u6587."),a.a.createElement("p",null,"\u5177\u4f53\u4ee3\u7801\u5982\u4e0b:"),a.a.createElement(l["a"],{code:"export function scheduleUpdateOnFiber(\n  fiber: Fiber,\n  expirationTime: ExpirationTime,\n) {\n  const priorityLevel = getCurrentPriorityLevel();\n\n  if (expirationTime === Sync) {\n    if (\n      // Check if we're inside unbatchedUpdates\n      (executionContext & LegacyUnbatchedContext) !== NoContext &&\n      // Check if we're not already rendering\n      (executionContext & (RenderContext | CommitContext)) === NoContext\n    ) {\n      performSyncWorkOnRoot(root);\n    } else {\n      ensureRootIsScheduled(root);\n      schedulePendingInteractions(root, expirationTime);\n      if (executionContext === NoContext) {\n        // Flush the synchronous work now, unless we're already working or inside\n        // a batch. This is intentionally inside scheduleUpdateOnFiber instead of\n        // scheduleCallbackForFiber to preserve the ability to schedule a callback\n        // without immediately flushing it. We only do this for user-initiated\n        // updates, to preserve historical behavior of legacy mode.\n        flushSyncCallbackQueue();\n      }\n    }\n  } else {\n    // Schedule a discrete update but only if it's not Sync.\n    if (\n      (executionContext & DiscreteEventContext) !== NoContext &&\n      // Only updates at user-blocking priority or greater are considered\n      // discrete, even inside a discrete event.\n      (priorityLevel === UserBlockingPriority ||\n        priorityLevel === ImmediatePriority)\n    ) {\n      // This is the result of a discrete event. Track the lowest priority\n      // discrete update per root so we can flush them early, if needed.\n      if (rootsWithPendingDiscreteUpdates === null) {\n        rootsWithPendingDiscreteUpdates = new Map([[root, expirationTime]]);\n      } else {\n        const lastDiscreteTime = rootsWithPendingDiscreteUpdates.get(root);\n        if (\n          lastDiscreteTime === undefined ||\n          lastDiscreteTime > expirationTime\n        ) {\n          rootsWithPendingDiscreteUpdates.set(root, expirationTime);\n        }\n      }\n    }\n    // Schedule other updates after in case the callback is sync.\n    ensureRootIsScheduled(root);\n    schedulePendingInteractions(root, expirationTime);\n  }\n}",lang:"js"}),a.a.createElement("p",null,"\u53ef\u4ee5\u770b\u5230, \u662f\u5426\u540c\u6b65\u6e32\u67d3\u8c03\u5ea6\u51b3\u5b9a\u4ee3\u7801\u662f",a.a.createElement("code",null,"flushSyncCallbackQueue()"),". \u8fdb\u5165\u8be5\u5206\u652f\u7684\u6761\u4ef6:"),a.a.createElement("ol",null,a.a.createElement("li",null,"\u5fc5\u987b\u662f",a.a.createElement("code",null,"legacy\u6a21\u5f0f"),", ",a.a.createElement("code",null,"concurrent"),"\u6a21\u5f0f\u4e0b",a.a.createElement("code",null,"expirationTime"),"\u4e0d\u4f1a\u4e3a",a.a.createElement("code",null,"Sync")),a.a.createElement("li",null,a.a.createElement("code",null,"executionContext === NoContext"),", \u6267\u884c\u4e0a\u4e0b\u6587\u5fc5\u987b\u8981\u4e3a\u7a7a.")),a.a.createElement("p",null,"\u4e24\u4e2a\u6761\u4ef6\u7f3a\u4e00\u4e0d\u53ef."),a.a.createElement("h2",{id:"\u7ed3\u8bba"},a.a.createElement(o["AnchorLink"],{to:"#\u7ed3\u8bba","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u7ed3\u8bba"),a.a.createElement("p",null,"\u540c\u6b65:"),a.a.createElement("ol",null,a.a.createElement("li",null,"\u9996\u5148\u5728",a.a.createElement("code",null,"legacy\u6a21\u5f0f"),"\u4e0b"),a.a.createElement("li",null,"\u5728\u6267\u884c\u4e0a\u4e0b\u6587\u4e3a\u7a7a\u7684\u65f6\u5019\u53bb\u8c03\u7528",a.a.createElement("code",null,"setState"),a.a.createElement("ul",null,a.a.createElement("li",null,"\u53ef\u4ee5\u4f7f\u7528\u5f02\u6b65\u8c03\u7528\u5982",a.a.createElement("code",null,"setTimeout"),", ",a.a.createElement("code",null,"Promise"),", ",a.a.createElement("code",null,"MessageChannel"),"\u7b49"),a.a.createElement("li",null,"\u53ef\u4ee5\u76d1\u542c\u539f\u751f\u4e8b\u4ef6, \u6ce8\u610f\u4e0d\u662f\u5408\u6210\u4e8b\u4ef6, \u5728\u539f\u751f\u4e8b\u4ef6\u7684\u56de\u8c03\u51fd\u6570\u4e2d\u6267\u884c setState \u5c31\u662f\u540c\u6b65\u7684")))),a.a.createElement("p",null,"\u5f02\u6b65:"),a.a.createElement("ol",null,a.a.createElement("li",null,"\u5982\u679c\u662f\u5408\u6210\u4e8b\u4ef6\u4e2d\u7684\u56de\u8c03, ",a.a.createElement("code",null,"executionContext |= DiscreteEventContext"),", \u6240\u4ee5\u4e0d\u4f1a\u8fdb\u5165, \u6700\u7ec8\u8868\u73b0\u51fa\u5f02\u6b65"),a.a.createElement("li",null,"concurrent \u6a21\u5f0f\u4e0b\u90fd\u4e3a\u5f02\u6b65")),a.a.createElement("h2",{id:"\u6f14\u793a\u793a\u4f8b"},a.a.createElement(o["AnchorLink"],{to:"#\u6f14\u793a\u793a\u4f8b","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u6f14\u793a\u793a\u4f8b")),a.a.createElement(c["default"],u["default"]["01-setstate-demo"].previewerProps,a.a.createElement(i,null)),a.a.createElement("div",{className:"markdown"},a.a.createElement("p",null,"\u5728\u770b\u4e00\u4e2a concurrent \u6a21\u5f0f\u4e0b\u7684\u4f8b\u5b50, \u76f8\u540c\u7684\u4ee3\u7801\u90fd\u4e3a\u5f02\u6b65 render:"),a.a.createElement("p",null,a.a.createElement(o["Link"],{to:"https://codesandbox.io/s/boring-faraday-m7jtx?fontsize=14&hidenavigation=1&theme=dark"},a.a.createElement("img",{src:"https://codesandbox.io/static/img/play-codesandbox.svg",alt:"Edit boring-faraday-m7jtx"})))))))}}]);