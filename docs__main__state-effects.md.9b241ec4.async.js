(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[34],{JjdP:function(e,t,n){"use strict";n.r(t);var a=n("HaE+"),l=n("o0o1"),c=n.n(l),r=n("LtsZ");t["default"]={"dfs-demo":{component:Object(r["dynamic"])({loader:function(){var e=Object(a["a"])(c.a.mark((function e(){var t,a,l,r,o,u,i,s,m;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=n("TqRt"),e.t0=a,e.next=4,n.e(5).then(n.bind(null,"1OyB"));case 4:return e.t1=e.sent,l=(0,e.t0)(e.t1),e.t2=a,e.next=9,n.e(6).then(n.bind(null,"vuIU"));case 9:return e.t3=e.sent,r=(0,e.t2)(e.t3),e.t4=a,e.next=14,n.e(7).then(n.bind(null,"Ji7U"));case 14:return e.t5=e.sent,o=(0,e.t4)(e.t5),e.t6=a,e.next=19,n.e(4).then(n.bind(null,"LK+K"));case 19:return e.t7=e.sent,u=(0,e.t6)(e.t7),i=function(e){(0,o["default"])(a,e);var n=(0,u["default"])(a);function a(){return(0,l["default"])(this,a),n.apply(this,arguments)}return(0,r["default"])(a,[{key:"render",value:function(){return t.createElement("div",{className:"app"},t.createElement("header",null,"header"),t.createElement(s,null),t.createElement("footer",null,"footer"))}}]),a}(t.Component),s=function(e){(0,o["default"])(a,e);var n=(0,u["default"])(a);function a(){return(0,l["default"])(this,a),n.apply(this,arguments)}return(0,r["default"])(a,[{key:"render",value:function(){return t.createElement(t.Fragment,null,t.createElement("p",null,"1"),t.createElement("p",null,"2"),t.createElement("p",null,"3"))}}]),a}(t.Component),m=i,e.abrupt("return",m);case 25:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:'class App extends React.Component {\n  render() {\n    return (\n      <div className="app">\n        <header>header</header>\n        <Content />\n        <footer>footer</footer>\n      </div>\n    );\n  }\n}\n\nclass Content extends React.Component {\n  render() {\n    return (\n      <React.Fragment>\n        <p>1</p>\n        <p>2</p>\n        <p>3</p>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default App;'}},dependencies:{},identifier:"dfs-demo"}},"01-setstate-demo":{component:Object(r["dynamic"])({loader:function(){var e=Object(a["a"])(c.a.mark((function e(){var t,a,l,r,o,u,i;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n("TqRt"),e.t0=t,e.next=4,n.e(5).then(n.bind(null,"1OyB"));case 4:return e.t1=e.sent,a=(0,e.t0)(e.t1),e.t2=t,e.next=9,n.e(6).then(n.bind(null,"vuIU"));case 9:return e.t3=e.sent,l=(0,e.t2)(e.t3),e.t4=t,e.next=14,n.e(7).then(n.bind(null,"Ji7U"));case 14:return e.t5=e.sent,r=(0,e.t4)(e.t5),e.t6=t,e.next=19,n.e(4).then(n.bind(null,"LK+K"));case 19:return e.t7=e.sent,o=(0,e.t6)(e.t7),e.t8=t,e.next=24,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 24:return e.t9=e.sent,u=(0,e.t8)(e.t9),i=function(e){(0,r["default"])(n,e);var t=(0,o["default"])(n);function n(){var e;(0,a["default"])(this,n);for(var l=arguments.length,c=new Array(l),r=0;r<l;r++)c[r]=arguments[r];return e=t.call.apply(t,[this].concat(c)),e.state={count:0},e.changeState=function(){var t=e.state.count+1;e.setState({count:e.state.count+1}),t===e.state.count?console.log("\u540c\u6b65\u6267\u884crender"):console.log("\u5f02\u6b65\u6267\u884crender")},e.changeState2=function(){var t=e.state.count+1;Promise.resolve().then((function(){e.setState({count:e.state.count+1}),t===e.state.count?console.log("\u540c\u6b65\u6267\u884crender"):console.log("\u5f02\u6b65\u6267\u884crender")}))},e}return(0,l["default"])(n,[{key:"render",value:function(){return u["default"].createElement("div",null,u["default"].createElement("p",null,"\u5f53\u524dcount=",this.state.count),u["default"].createElement("button",{onClick:this.changeState},"\u5f02\u6b65+1"),u["default"].createElement("button",{onClick:this.changeState2},"\u540c\u6b65+1"))}}]),n}(u["default"].Component),e.abrupt("return",i);case 28:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React from 'react';\n\nexport default class App extends React.Component {\n  state = {\n    count: 0,\n  };\n\n  changeState = () => {\n    const newCount = this.state.count + 1;\n    this.setState({\n      count: this.state.count + 1,\n    });\n    if (newCount === this.state.count) {\n      console.log('\u540c\u6b65\u6267\u884crender');\n    } else {\n      console.log('\u5f02\u6b65\u6267\u884crender');\n    }\n  };\n\n  changeState2 = () => {\n    const newCount = this.state.count + 1;\n    Promise.resolve().then(() => {\n      this.setState({\n        count: this.state.count + 1,\n      });\n      if (newCount === this.state.count) {\n        console.log('\u540c\u6b65\u6267\u884crender');\n      } else {\n        console.log('\u5f02\u6b65\u6267\u884crender');\n      }\n    });\n  };\n\n  render() {\n    return (\n      <div>\n        <p>\u5f53\u524dcount={this.state.count}</p>\n        <button onClick={this.changeState}>\u5f02\u6b65+1</button>\n        <button onClick={this.changeState2}>\u540c\u6b65+1</button>\n      </div>\n    );\n  }\n}"}},dependencies:{react:{version:"17.0.2"}},identifier:"01-setstate-demo"}},"hook-state-demo":{component:Object(r["dynamic"])({loader:function(){var e=Object(a["a"])(c.a.mark((function e(){var t,a,l,r,o,u;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=function(){var e=(0,l.useState)(0),t=(0,a["default"])(e,2),n=t[0],c=t[1];return l["default"].createElement("button",{onClick:function(){c(1),c(3),c(2)}},n)},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var a={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var o=l?Object.getOwnPropertyDescriptor(e,c):null;o&&(o.get||o.set)?Object.defineProperty(a,c,o):a[c]=e[c]}return a["default"]=e,n&&n.set(e,a),a},r=function(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)},t=n("TqRt"),e.t0=t,e.next=7,n.e(3).then(n.bind(null,"ODXe"));case 7:return e.t1=e.sent,a=(0,e.t0)(e.t1),e.t2=o,e.next=12,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 12:return e.t3=e.sent,l=(0,e.t2)(e.t3),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React, { useState } from 'react';\nexport default function App() {\n  const [count, dispatch] = useState(0);\n  return (\n    <button\n      onClick={() => {\n        dispatch(1);\n        dispatch(3);\n        dispatch(2);\n      }}\n    >\n      {count}\n    </button>\n  );\n}"}},dependencies:{react:{version:"17.0.2"}},identifier:"hook-state-demo"}},"hook-summary-demo":{component:Object(r["dynamic"])({loader:function(){var e=Object(a["a"])(c.a.mark((function e(){var t,a,l,r,o,u;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=function(){var e=(0,l.useState)(1),t=(0,a["default"])(e,2),n=t[0],c=t[1];(0,l.useEffect)((function(){console.log("effect 1 created")}));var r=(0,l.useState)(2),o=(0,a["default"])(r,1),u=o[0];return(0,l.useEffect)((function(){console.log("effect 2 created")})),l["default"].createElement(l["default"].Fragment,null,l["default"].createElement("button",{onClick:function(){return c(n+1)}},n),l["default"].createElement("button",null,u))},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var a={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var o=l?Object.getOwnPropertyDescriptor(e,c):null;o&&(o.get||o.set)?Object.defineProperty(a,c,o):a[c]=e[c]}return a["default"]=e,n&&n.set(e,a),a},r=function(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)},t=n("TqRt"),e.t0=t,e.next=7,n.e(3).then(n.bind(null,"ODXe"));case 7:return e.t1=e.sent,a=(0,e.t0)(e.t1),e.t2=o,e.next=12,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 12:return e.t3=e.sent,l=(0,e.t2)(e.t3),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React, { useState, useEffect } from 'react';\nexport default function App() {\n  // 1. useState\n  const [a, setA] = useState(1);\n  // 2. useEffect\n  useEffect(() => {\n    console.log(`effect 1 created`);\n  });\n  // 3. useState\n  const [b] = useState(2);\n  // 4. useEffect\n  useEffect(() => {\n    console.log(`effect 2 created`);\n  });\n  return (\n    <>\n      <button onClick={() => setA(a + 1)}>{a}</button>\n      <button>{b}</button>\n    </>\n  );\n}"}},dependencies:{react:{version:"17.0.2"}},identifier:"hook-summary-demo"}},"hook-demo":{component:Object(r["dynamic"])({loader:function(){var e=Object(a["a"])(c.a.mark((function e(){var t,a,l,r,o,u,i;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=function(){Promise.resolve().then((function(){console.log("\u6240\u6709\u7684effect.create\u90fd\u662f\u901a\u8fc7\u8c03\u5ea6\u5668(scheduler)\u5f02\u6b65(MessageChannel)\u6267\u884c\u7684, \u6545effect.create\u51fd\u6570\u5fc5\u7136\u5728\u6b64\u4e4b\u540e\u6267\u884c")}));var e=(0,l.useState)(0),t=(0,a["default"])(e,2),n=t[0],c=t[1];return(0,l.useEffect)((function(){return console.log("\u7b2c1\u4e2aeffect.create dps: []"),function(){console.log("\u7b2c1\u4e2aeffect.destory")}}),[]),(0,l.useEffect)((function(){return console.log("effect.create dps: [count]",n),function(){console.log("\u7b2c2\u4e2aeffect.destory dps: [count]",n)}}),[n]),l["default"].createElement(l["default"].Fragment,null,l["default"].createElement("p",null,"You clicked ",n," times"),l["default"].createElement("button",{onClick:function(){return c(n+1)}},"Click me"))},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var a={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var o=l?Object.getOwnPropertyDescriptor(e,c):null;o&&(o.get||o.set)?Object.defineProperty(a,c,o):a[c]=e[c]}return a["default"]=e,n&&n.set(e,a),a},r=function(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)},t=n("TqRt"),e.t0=t,e.next=7,n.e(3).then(n.bind(null,"ODXe"));case 7:return e.t1=e.sent,a=(0,e.t0)(e.t1),e.t2=o,e.next=12,Promise.resolve().then(n.t.bind(null,"q1tI",7));case 12:return e.t3=e.sent,l=(0,e.t2)(e.t3),i=u,e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),previewerProps:{sources:{_:{jsx:"import React, { useState, useEffect } from 'react';\nfunction Example() {\n  Promise.resolve().then(() => {\n    console.log(\n      '\u6240\u6709\u7684effect.create\u90fd\u662f\u901a\u8fc7\u8c03\u5ea6\u5668(scheduler)\u5f02\u6b65(MessageChannel)\u6267\u884c\u7684, \u6545effect.create\u51fd\u6570\u5fc5\u7136\u5728\u6b64\u4e4b\u540e\u6267\u884c',\n    );\n  });\n  // \u7b2c1\u4e2ahook(useState)\n  const [count, setCount] = useState(0);\n  // \u7b2c2\u4e2ahook(useEffect)\n  useEffect(() => {\n    console.log('\u7b2c1\u4e2aeffect.create dps: []');\n    return () => {\n      console.log('\u7b2c1\u4e2aeffect.destory');\n    };\n  }, []);\n  // \u7b2c3\u4e2ahook(useEffect)\n  useEffect(() => {\n    console.log('effect.create dps: [count]', count);\n    return () => {\n      console.log('\u7b2c2\u4e2aeffect.destory dps: [count]', count);\n    };\n  }, [count]);\n  return (\n    <>\n      <p>You clicked {count} times</p>\n      <button onClick={() => setCount(count + 1)}>Click me</button>\n    </>\n  );\n}\nexport default Example;"}},dependencies:{react:{version:"17.0.2"}},identifier:"hook-demo"}}}},WcqN:function(e,t,n){"use strict";n.r(t);var a=n("q1tI"),l=n.n(a),c=n("dEAq"),r=n("H1Ra");n("JjdP");t["default"]=e=>(l.a.useEffect((()=>{var t;null!==e&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&t.hash&&c["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"markdown"},l.a.createElement("h1",{id:"\u72b6\u6001\u4e0e\u526f\u4f5c\u7528"},l.a.createElement(c["AnchorLink"],{to:"#\u72b6\u6001\u4e0e\u526f\u4f5c\u7528","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u72b6\u6001\u4e0e\u526f\u4f5c\u7528"),l.a.createElement("p",null,"\u5728\u524d\u6587\u6211\u4eec\u5df2\u7ecf\u5206\u6790\u4e86",l.a.createElement("code",null,"fiber\u6811"),"\u4ece",l.a.createElement("code",null,"\u6784\u9020"),"\u5230",l.a.createElement("code",null,"\u6e32\u67d3"),"\u7684\u5173\u952e\u8fc7\u7a0b. \u672c\u8282\u6211\u4eec\u7ad9\u5728",l.a.createElement("code",null,"fiber"),"\u5bf9\u8c61\u7684\u89c6\u89d2, \u8003\u8651\u4e00\u4e2a\u5177\u4f53\u7684",l.a.createElement("code",null,"fiber"),"\u8282\u70b9\u5982\u4f55\u5f71\u54cd\u6700\u7ec8\u7684\u6e32\u67d3."),l.a.createElement("p",null,"\u56de\u987e",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactInternalTypes.js#L47-L174"},"fiber \u6570\u636e\u7ed3\u6784"),", \u5e76\u7ed3\u5408\u524d\u6587",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u7cfb\u5217\u7684\u89e3\u8bfb, \u6211\u4eec\u6ce8\u610f\u5230",l.a.createElement("code",null,"fiber"),"\u4f17\u591a\u5c5e\u6027\u4e2d, \u6709 2 \u7c7b\u5c5e\u6027\u5341\u5206\u5173\u952e:"),l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("p",null,l.a.createElement("code",null,"fiber"),"\u8282\u70b9\u7684\u81ea\u8eab\u72b6\u6001: \u5728",l.a.createElement("code",null,"renderRootSync[Concurrent]"),"\u9636\u6bb5, \u4e3a\u5b50\u8282\u70b9\u63d0\u4f9b\u786e\u5b9a\u7684\u8f93\u5165\u6570\u636e, \u76f4\u63a5\u5f71\u54cd\u5b50\u8282\u70b9\u7684\u751f\u6210.")),l.a.createElement("li",null,l.a.createElement("p",null,l.a.createElement("code",null,"fiber"),"\u8282\u70b9\u7684\u526f\u4f5c\u7528: \u5728",l.a.createElement("code",null,"commitRoot"),"\u9636\u6bb5, \u5982\u679c",l.a.createElement("code",null,"fiber"),"\u88ab\u6807\u8bb0\u6709\u526f\u4f5c\u7528, \u5219\u526f\u4f5c\u7528\u76f8\u5173\u51fd\u6570\u4f1a\u88ab(\u540c\u6b65/\u5f02\u6b65)\u8c03\u7528."))),l.a.createElement(r["a"],{code:"export type Fiber = {|\n  // 1. fiber\u8282\u70b9\u81ea\u8eab\u72b6\u6001\u76f8\u5173\n  pendingProps: any,\n  memoizedProps: any,\n  updateQueue: mixed,\n  memoizedState: any,\n\n  // 2. fiber\u8282\u70b9\u526f\u4f5c\u7528(Effect)\u76f8\u5173\n  flags: Flags,\n  subtreeFlags: Flags, // v17.0.2\u672a\u542f\u7528\n  deletions: Array<Fiber> | null, // v17.0.2\u672a\u542f\u7528\n  nextEffect: Fiber | null,\n  firstEffect: Fiber | null,\n  lastEffect: Fiber | null,\n|};",lang:"js"}),l.a.createElement("h2",{id:"\u72b6\u6001"},l.a.createElement(c["AnchorLink"],{to:"#\u72b6\u6001","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u72b6\u6001"),l.a.createElement("p",null,"\u4e0e",l.a.createElement("code",null,"\u72b6\u6001"),"\u76f8\u5173\u6709 4 \u4e2a\u5c5e\u6027:"),l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("code",null,"fiber.pendingProps"),": \u8f93\u5165\u5c5e\u6027, \u4ece",l.a.createElement("code",null,"ReactElement"),"\u5bf9\u8c61\u4f20\u5165\u7684 props. \u5b83\u548c",l.a.createElement("code",null,"fiber.memoizedProps"),"\u6bd4\u8f83\u53ef\u4ee5\u5f97\u51fa\u5c5e\u6027\u662f\u5426\u53d8\u52a8."),l.a.createElement("li",null,l.a.createElement("code",null,"fiber.memoizedProps"),": \u4e0a\u4e00\u6b21\u751f\u6210\u5b50\u8282\u70b9\u65f6\u7528\u5230\u7684\u5c5e\u6027, \u751f\u6210\u5b50\u8282\u70b9\u4e4b\u540e\u4fdd\u6301\u5728\u5185\u5b58\u4e2d. \u5411\u4e0b\u751f\u6210\u5b50\u8282\u70b9\u4e4b\u524d\u53eb\u505a",l.a.createElement("code",null,"pendingProps"),", \u751f\u6210\u5b50\u8282\u70b9\u4e4b\u540e\u4f1a\u628a",l.a.createElement("code",null,"pendingProps"),"\u8d4b\u503c\u7ed9",l.a.createElement("code",null,"memoizedProps"),"\u7528\u4e8e\u4e0b\u4e00\u6b21\u6bd4\u8f83.",l.a.createElement("code",null,"pendingProps"),"\u548c",l.a.createElement("code",null,"memoizedProps"),"\u6bd4\u8f83\u53ef\u4ee5\u5f97\u51fa\u5c5e\u6027\u662f\u5426\u53d8\u52a8."),l.a.createElement("li",null,l.a.createElement("code",null,"fiber.updateQueue"),": \u5b58\u50a8",l.a.createElement("code",null,"update\u66f4\u65b0\u5bf9\u8c61"),"\u7684\u961f\u5217, \u6bcf\u4e00\u6b21\u53d1\u8d77\u66f4\u65b0, \u90fd\u9700\u8981\u5728\u8be5\u961f\u5217\u4e0a\u521b\u5efa\u4e00\u4e2a",l.a.createElement("code",null,"update\u5bf9\u8c61"),"."),l.a.createElement("li",null,l.a.createElement("code",null,"fiber.memoizedState"),": \u4e0a\u4e00\u6b21\u751f\u6210\u5b50\u8282\u70b9\u4e4b\u540e\u4fdd\u6301\u5728\u5185\u5b58\u4e2d\u7684\u5c40\u90e8\u72b6\u6001.")),l.a.createElement("p",null,"\u5b83\u4eec\u7684\u4f5c\u7528\u53ea\u5c40\u9650\u4e8e",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u9636\u6bb5, \u76f4\u63a5\u5f71\u54cd\u5b50\u8282\u70b9\u7684\u751f\u6210."),l.a.createElement("h2",{id:"\u526f\u4f5c\u7528"},l.a.createElement(c["AnchorLink"],{to:"#\u526f\u4f5c\u7528","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u526f\u4f5c\u7528"),l.a.createElement("p",null,"\u4e0e",l.a.createElement("code",null,"\u526f\u4f5c\u7528"),"\u76f8\u5173\u6709 4 \u4e2a\u5c5e\u6027:"),l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("code",null,"fiber.flags"),": \u6807\u5fd7\u4f4d, \u8868\u660e\u8be5",l.a.createElement("code",null,"fiber"),"\u8282\u70b9\u6709\u526f\u4f5c\u7528(\u5728 v17.0.2 \u4e2d\u5171\u5b9a\u4e49\u4e86",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberFlags.js#L13"},"28 \u79cd\u526f\u4f5c\u7528"),")."),l.a.createElement("li",null,l.a.createElement("code",null,"fiber.nextEffect"),": \u5355\u5411\u94fe\u8868, \u6307\u5411\u4e0b\u4e00\u4e2a\u526f\u4f5c\u7528 ",l.a.createElement("code",null,"fiber"),"\u8282\u70b9."),l.a.createElement("li",null,l.a.createElement("code",null,"fiber.firstEffect"),": \u5355\u5411\u94fe\u8868, \u6307\u5411\u7b2c\u4e00\u4e2a\u526f\u4f5c\u7528 ",l.a.createElement("code",null,"fiber")," \u8282\u70b9."),l.a.createElement("li",null,l.a.createElement("code",null,"fiber.lastEffect"),": \u5355\u5411\u94fe\u8868, \u6307\u5411\u6700\u540e\u4e00\u4e2a\u526f\u4f5c\u7528 ",l.a.createElement("code",null,"fiber")," \u8282\u70b9.")),l.a.createElement("p",null,"\u901a\u8fc7\u524d\u6587",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u6211\u4eec\u77e5\u9053, \u5355\u4e2a",l.a.createElement("code",null,"fiber"),"\u8282\u70b9\u7684\u526f\u4f5c\u7528\u961f\u5217\u6700\u540e\u90fd\u4f1a\u4e0a\u79fb\u5230\u6839\u8282\u70b9\u4e0a. \u6240\u4ee5\u5728",l.a.createElement("code",null,"commitRoot"),"\u9636\u6bb5\u4e2d, ",l.a.createElement("code",null,"react"),"\u63d0\u4f9b\u4e86 3 \u79cd\u5904\u7406\u526f\u4f5c\u7528\u7684\u65b9\u5f0f(\u8be6\u89c1",l.a.createElement(c["AnchorLink"],{to:"./fibertree-commit#%E6%B8%B2%E6%9F%93"},"fiber \u6811\u6e32\u67d3"),")."),l.a.createElement("p",null,"\u53e6\u5916, ",l.a.createElement("code",null,"\u526f\u4f5c\u7528"),"\u7684\u8bbe\u8ba1\u53ef\u4ee5\u7406\u89e3\u4e3a\u5bf9",l.a.createElement("code",null,"\u72b6\u6001"),"\u529f\u80fd\u4e0d\u8db3\u7684\u8865\u5145."),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"\u72b6\u6001"),"\u662f\u4e00\u4e2a",l.a.createElement("code",null,"\u9759\u6001"),"\u7684\u529f\u80fd, \u5b83\u53ea\u80fd\u4e3a\u5b50\u8282\u70b9\u63d0\u4f9b\u6570\u636e\u6e90."),l.a.createElement("li",null,"\u800c",l.a.createElement("code",null,"\u526f\u4f5c\u7528"),"\u662f\u4e00\u4e2a",l.a.createElement("code",null,"\u52a8\u6001"),"\u529f\u80fd, \u7531\u4e8e\u5b83\u7684\u8c03\u7528\u65f6\u673a\u662f\u5728",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3\u9636\u6bb5"),", \u6545\u5b83\u62e5\u6709\u66f4\u591a\u7684\u80fd\u529b, \u80fd\u8f7b\u677e\u83b7\u53d6",l.a.createElement("code",null,"\u7a81\u53d8\u524d\u5feb\u7167, \u7a81\u53d8\u540e\u7684DOM\u8282\u70b9\u7b49"),". \u751a\u81f3\u901a\u8fc7",l.a.createElement("code",null,"\u8c03\u7528api"),"\u53d1\u8d77\u65b0\u7684\u4e00\u8f6e",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),", \u8fdb\u800c\u6539\u53d8\u66f4\u591a\u7684",l.a.createElement("code",null,"\u72b6\u6001"),", \u5f15\u53d1\u66f4\u591a\u7684",l.a.createElement("code",null,"\u526f\u4f5c\u7528"),".")),l.a.createElement("h2",{id:"\u5916\u90e8-api"},l.a.createElement(c["AnchorLink"],{to:"#\u5916\u90e8-api","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u5916\u90e8 api"),l.a.createElement("p",null,l.a.createElement("code",null,"fiber"),"\u5bf9\u8c61\u7684\u8fd9 2 \u7c7b\u5c5e\u6027, \u53ef\u4ee5\u5f71\u54cd\u5230\u6e32\u67d3\u7ed3\u679c, \u4f46\u662f",l.a.createElement("code",null,"fiber"),"\u7ed3\u6784\u59cb\u7ec8\u662f\u4e00\u4e2a\u5185\u6838\u4e2d\u7684\u7ed3\u6784, \u5bf9\u4e8e\u5916\u90e8\u6765\u8bb2\u662f\u65e0\u611f\u77e5\u7684, \u5bf9\u4e8e\u8c03\u7528\u65b9\u6765\u8bb2, \u751a\u81f3\u90fd\u65e0\u9700\u77e5\u9053",l.a.createElement("code",null,"fiber"),"\u7ed3\u6784\u7684\u5b58\u5728. \u6240\u4ee5\u6b63\u5e38\u53ea\u6709\u901a\u8fc7\u66b4\u9732",l.a.createElement("code",null,"api"),"\u6765\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u4fee\u6539\u8fd9 2 \u7c7b\u5c5e\u6027."),l.a.createElement("p",null,"\u4ece",l.a.createElement("code",null,"react"),"\u5305\u66b4\u9732\u51fa\u7684",l.a.createElement("code",null,"api"),"\u6765\u5f52\u7eb3, \u53ea\u6709 2 \u7c7b\u7ec4\u4ef6\u652f\u6301\u4fee\u6539:"),l.a.createElement("blockquote",null,l.a.createElement("p",null,"\u672c\u8282\u53ea\u8ba8\u8bba\u4f7f\u7528",l.a.createElement("code",null,"api"),"\u7684\u76ee\u7684\u662f\u4fee\u6539",l.a.createElement("code",null,"fiber"),"\u7684",l.a.createElement("code",null,"\u72b6\u6001"),"\u548c",l.a.createElement("code",null,"\u526f\u4f5c\u7528"),", \u8fdb\u800c\u53ef\u4ee5\u6539\u53d8\u6574\u4e2a\u6e32\u67d3\u7ed3\u679c. \u672c\u8282\u5148\u4ecb\u7ecd api \u4e0e",l.a.createElement("code",null,"\u72b6\u6001"),"\u548c",l.a.createElement("code",null,"\u526f\u4f5c\u7528"),"\u7684\u8054\u7cfb, \u6709\u5173",l.a.createElement("code",null,"api"),"\u7684\u5177\u4f53\u5b9e\u73b0\u4f1a\u5728",l.a.createElement("code",null,"class\u7ec4\u4ef6"),",",l.a.createElement("code",null,"Hook\u539f\u7406"),"\u7ae0\u8282\u4e2d\u8be6\u7ec6\u5206\u6790.")),l.a.createElement("h3",{id:"class-\u7ec4\u4ef6"},l.a.createElement(c["AnchorLink"],{to:"#class-\u7ec4\u4ef6","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"class \u7ec4\u4ef6"),l.a.createElement(r["a"],{code:"class App extends React.Component {\n  constructor() {\n    this.state = {\n      // \u521d\u59cb\u72b6\u6001\n      a: 1,\n    };\n  }\n  changeState = () => {\n    this.setState({ a: ++this.state.a }); // \u8fdb\u5165reconciler\u6d41\u7a0b\n  };\n\n  // \u751f\u547d\u5468\u671f\u51fd\u6570: \u72b6\u6001\u76f8\u5173\n  static getDerivedStateFromProps(nextProps, prevState) {\n    console.log('getDerivedStateFromProps');\n    return prevState;\n  }\n\n  // \u751f\u547d\u5468\u671f\u51fd\u6570: \u72b6\u6001\u76f8\u5173\n  shouldComponentUpdate(newProps, newState, nextContext) {\n    console.log('shouldComponentUpdate');\n    return true;\n  }\n\n  // \u751f\u547d\u5468\u671f\u51fd\u6570: \u526f\u4f5c\u7528\u76f8\u5173 fiber.flags |= Update\n  componentDidMount() {\n    console.log('componentDidMount');\n  }\n\n  // \u751f\u547d\u5468\u671f\u51fd\u6570: \u526f\u4f5c\u7528\u76f8\u5173 fiber.flags |= Snapshot\n  getSnapshotBeforeUpdate(prevProps, prevState) {\n    console.log('getSnapshotBeforeUpdate');\n  }\n\n  // \u751f\u547d\u5468\u671f\u51fd\u6570: \u526f\u4f5c\u7528\u76f8\u5173 fiber.flags |= Update\n  componentDidUpdate() {\n    console.log('componentDidUpdate');\n  }\n\n  render() {\n    // \u8fd4\u56de\u4e0b\u7ea7ReactElement\u5bf9\u8c61\n    return <button onClick={this.changeState}>{this.state.a}</button>;\n  }\n}",lang:"js"}),l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u72b6\u6001\u76f8\u5173: ",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u9636\u6bb5."),l.a.createElement("ol",null,l.a.createElement("li",null,"\u6784\u9020\u51fd\u6570: ",l.a.createElement("code",null,"constructor"),"\u5b9e\u4f8b\u5316\u65f6\u6267\u884c, \u53ef\u4ee5\u8bbe\u7f6e\u521d\u59cb state, \u53ea\u6267\u884c\u4e00\u6b21."),l.a.createElement("li",null,"\u751f\u547d\u5468\u671f: ",l.a.createElement("code",null,"getDerivedStateFromProps"),"\u5728",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u9636\u6bb5(",l.a.createElement("code",null,"renderRootSync[Concurrent]"),")\u6267\u884c, \u53ef\u4ee5\u4fee\u6539 state(",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberClassComponent.old.js#L867-L875"},"\u94fe\u63a5"),")."),l.a.createElement("li",null,"\u751f\u547d\u5468\u671f: ",l.a.createElement("code",null,"shouldComponentUpdate"),"\u5728, ",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u9636\u6bb5(",l.a.createElement("code",null,"renderRootSync[Concurrent]"),")\u6267\u884c, \u8fd4\u56de\u503c\u51b3\u5b9a\u662f\u5426\u6267\u884c render(",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberClassComponent.old.js#L1135-L1143"},"\u94fe\u63a5"),")."))),l.a.createElement("li",null,l.a.createElement("p",null,"\u526f\u4f5c\u7528\u76f8\u5173: ",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u9636\u6bb5."),l.a.createElement("ol",null,l.a.createElement("li",null,"\u751f\u547d\u5468\u671f: ",l.a.createElement("code",null,"getSnapshotBeforeUpdate"),"\u5728",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u9636\u6bb5(",l.a.createElement("code",null,"commitRoot->commitBeforeMutationEffects->commitBeforeMutationEffectOnFiber"),")\u6267\u884c(",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberCommitWork.old.js#L264"},"\u94fe\u63a5"),")."),l.a.createElement("li",null,"\u751f\u547d\u5468\u671f: ",l.a.createElement("code",null,"componentDidMount"),"\u5728",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u9636\u6bb5(",l.a.createElement("code",null,"commitRoot->commitLayoutEffects->commitLayoutEffectOnFiber"),")\u6267\u884c(",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberCommitWork.old.js#L533"},"\u94fe\u63a5"),")."),l.a.createElement("li",null,"\u751f\u547d\u5468\u671f: ",l.a.createElement("code",null,"componentDidUpdate"),"\u5728",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u9636\u6bb5(",l.a.createElement("code",null,"commitRoot->commitLayoutEffects->commitLayoutEffectOnFiber"),")\u6267\u884c(",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberCommitWork.old.js#L587"},"\u94fe\u63a5"),").")))),l.a.createElement("p",null,"\u53ef\u4ee5\u770b\u5230, \u5b98\u65b9",l.a.createElement("code",null,"api"),"\u63d0\u4f9b\u7684",l.a.createElement("code",null,"class\u7ec4\u4ef6"),"\u751f\u547d\u5468\u671f\u51fd\u6570\u5b9e\u9645\u4e0a\u4e5f\u662f\u56f4\u7ed5",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u548c",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u6765\u63d0\u4f9b\u7684."),l.a.createElement("h3",{id:"function-\u7ec4\u4ef6"},l.a.createElement(c["AnchorLink"],{to:"#function-\u7ec4\u4ef6","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"function \u7ec4\u4ef6"),l.a.createElement("p",null,"\u6ce8: ",l.a.createElement("code",null,"function\u7ec4\u4ef6"),"\u4e0e",l.a.createElement("code",null,"class\u7ec4\u4ef6"),"\u6700\u5927\u7684\u4e0d\u540c\u662f: ",l.a.createElement("code",null,"class\u7ec4\u4ef6"),"\u4f1a\u5b9e\u4f8b\u5316\u4e00\u4e2a",l.a.createElement("code",null,"instance"),"\u6240\u4ee5\u62e5\u6709\u72ec\u7acb\u7684\u5c40\u90e8\u72b6\u6001; \u800c",l.a.createElement("code",null,"function\u7ec4\u4ef6"),"\u4e0d\u4f1a\u5b9e\u4f8b\u5316, \u5b83\u53ea\u662f\u88ab\u76f4\u63a5\u8c03\u7528, \u6545\u65e0\u6cd5\u7ef4\u62a4\u4e00\u4efd\u72ec\u7acb\u7684\u5c40\u90e8\u72b6\u6001, \u53ea\u80fd\u4f9d\u9760",l.a.createElement("code",null,"Hook"),"\u5bf9\u8c61\u95f4\u63a5\u5b9e\u73b0\u5c40\u90e8\u72b6\u6001(\u6709\u5173\u66f4\u591a",l.a.createElement("code",null,"Hook"),"\u5b9e\u73b0\u7ec6\u8282, \u5728",l.a.createElement("code",null,"Hook\u539f\u7406"),"\u7ae0\u8282\u4e2d\u8be6\u7ec6\u8ba8\u8bba)."),l.a.createElement("p",null,"\u5728",l.a.createElement("code",null,"v17.0.2"),"\u4e2d\u5171\u5b9a\u4e49\u4e86",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberHooks.old.js#L111-L125"},"14 \u79cd Hook"),", \u5176\u4e2d\u6700\u5e38\u7528\u7684",l.a.createElement("code",null,"useState, useEffect, useLayoutEffect\u7b49")),l.a.createElement(r["a"],{code:"function App() {\n  // \u72b6\u6001\u76f8\u5173: \u521d\u59cb\u72b6\u6001\n  const [a, setA] = useState(1);\n  const changeState = () => {\n    setA(++a); // \u8fdb\u5165reconciler\u6d41\u7a0b\n  };\n\n  // \u526f\u4f5c\u7528\u76f8\u5173: fiber.flags |= Update | Passive;\n  useEffect(() => {\n    console.log(`useEffect`);\n  }, []);\n\n  // \u526f\u4f5c\u7528\u76f8\u5173: fiber.flags |= Update;\n  useLayoutEffect(() => {\n    console.log(`useLayoutEffect`);\n  }, []);\n\n  // \u8fd4\u56de\u4e0b\u7ea7ReactElement\u5bf9\u8c61\n  return <button onClick={changeState}>{a}</button>;\n}",lang:"js"}),l.a.createElement("ol",null,l.a.createElement("li",null,"\u72b6\u6001\u76f8\u5173: ",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u9636\u6bb5.",l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("code",null,"useState"),"\u5728",l.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u9636\u6bb5(",l.a.createElement("code",null,"renderRootSync[Concurrent]"),")\u6267\u884c, \u53ef\u4ee5\u4fee\u6539",l.a.createElement("code",null,"Hook.memoizedState"),"."))),l.a.createElement("li",null,"\u526f\u4f5c\u7528\u76f8\u5173: ",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u9636\u6bb5.",l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("code",null,"useEffect"),"\u5728",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u9636\u6bb5(",l.a.createElement("code",null,"commitRoot->commitBeforeMutationEffects->commitBeforeMutationEffectOnFiber"),")\u6267\u884c(\u6ce8\u610f\u662f\u5f02\u6b65\u6267\u884c, ",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L2290-L2295"},"\u94fe\u63a5"),")."),l.a.createElement("li",null,l.a.createElement("code",null,"useLayoutEffect"),"\u5728",l.a.createElement("code",null,"fiber\u6811\u6e32\u67d3"),"\u9636\u6bb5(",l.a.createElement("code",null,"commitRoot->commitLayoutEffects->commitLayoutEffectOnFiber->commitHookEffectListMount"),")\u6267\u884c(\u540c\u6b65\u6267\u884c, ",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberCommitWork.old.js#L481"},"\u94fe\u63a5"),").")))),l.a.createElement("h3",{id:"\u7ec6\u8282\u4e0e\u8bef\u533a"},l.a.createElement(c["AnchorLink"],{to:"#\u7ec6\u8282\u4e0e\u8bef\u533a","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u7ec6\u8282\u4e0e\u8bef\u533a"),l.a.createElement("p",null,"\u8fd9\u91cc\u6709 2 \u4e2a\u7ec6\u8282:"),l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("code",null,"useEffect(function()","{","}",", [])"),"\u4e2d\u7684\u51fd\u6570\u662f",l.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L2290-L2295"},"\u5f02\u6b65\u6267\u884c"),", \u56e0\u4e3a\u5b83\u7ecf\u8fc7\u4e86\u8c03\u5ea6\u4e2d\u5fc3(\u5177\u4f53\u5b9e\u73b0\u53ef\u4ee5\u56de\u987e",l.a.createElement(c["Link"],{to:"./scheduler"},"\u8c03\u5ea6\u539f\u7406"),")."),l.a.createElement("li",null,l.a.createElement("code",null,"useLayoutEffect"),"\u548c",l.a.createElement("code",null,"Class\u7ec4\u4ef6"),"\u4e2d\u7684",l.a.createElement("code",null,"componentDidMount,componentDidUpdate"),"\u4ece\u8c03\u7528\u65f6\u673a\u4e0a\u6765\u8bb2\u662f\u7b49\u4ef7\u7684, \u56e0\u4e3a\u4ed6\u4eec\u90fd\u5728",l.a.createElement("code",null,"commitRoot->commitLayoutEffects"),"\u51fd\u6570\u4e2d\u88ab\u8c03\u7528.",l.a.createElement("ul",null,l.a.createElement("li",null,"\u8bef\u533a: \u867d\u7136\u5b98\u7f51\u6587\u6863\u63a8\u8350\u5c3d\u53ef\u80fd\u4f7f\u7528\u6807\u51c6\u7684 ",l.a.createElement("code",null,"useEffect")," \u4ee5\u907f\u514d\u963b\u585e\u89c6\u89c9\u66f4\u65b0 , \u6240\u4ee5\u5f88\u591a\u5f00\u53d1\u8005\u4f7f\u7528",l.a.createElement("code",null,"useEffect"),"\u6765\u4ee3\u66ff",l.a.createElement("code",null,"componentDidMount,componentDidUpdate"),"\u662f\u4e0d\u51c6\u786e\u7684, \u5982\u679c\u5b8c\u5168\u7c7b\u6bd4, ",l.a.createElement("code",null,"useLayoutEffect"),"\u6bd4",l.a.createElement("code",null,"useEffect"),"\u66f4\u7b26\u5408",l.a.createElement("code",null,"componentDidMount,componentDidUpdate"),"\u7684\u5b9a\u4e49.")))),l.a.createElement("p",null,"\u4e3a\u4e86\u9a8c\u8bc1\u4e0a\u8ff0\u7ed3\u8bba, \u53ef\u4ee5\u67e5\u770b",l.a.createElement(c["Link"],{to:"https://codesandbox.io/s/fervent-napier-1ysb5"},"codesandbox \u4e2d\u7684\u4f8b\u5b50"),"."),l.a.createElement("h2",{id:"\u603b\u7ed3"},l.a.createElement(c["AnchorLink"],{to:"#\u603b\u7ed3","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u603b\u7ed3"),l.a.createElement("p",null,"\u672c\u8282\u4ece",l.a.createElement("code",null,"fiber"),"\u89c6\u89d2\u51fa\u53d1, \u603b\u7ed3\u4e86",l.a.createElement("code",null,"fiber"),"\u8282\u70b9\u4e2d\u53ef\u4ee5\u5f71\u54cd\u6700\u7ec8\u6e32\u67d3\u7ed3\u679c\u7684 2 \u7c7b\u5c5e\u6027(",l.a.createElement("code",null,"\u72b6\u6001"),"\u548c",l.a.createElement("code",null,"\u526f\u4f5c\u7528"),").\u5e76\u4e14\u5f52\u7eb3\u4e86",l.a.createElement("code",null,"class"),"\u548c",l.a.createElement("code",null,"function"),"\u7ec4\u4ef6\u4e2d, \u76f4\u63a5\u6216\u95f4\u63a5\u66f4\u6539",l.a.createElement("code",null,"fiber"),"\u5c5e\u6027\u7684\u5e38\u7528\u65b9\u5f0f. \u6700\u540e\u4ece",l.a.createElement("code",null,"fiber\u6811\u6784\u9020\u548c\u6e32\u67d3"),"\u7684\u89d2\u5ea6\u5bf9",l.a.createElement("code",null,"class\u7684\u751f\u547d\u5468\u671f\u51fd\u6570"),"\u4e0e",l.a.createElement("code",null,"function\u7684Hooks\u51fd\u6570"),"\u8fdb\u884c\u4e86\u6bd4\u8f83."))))},Zs1V:function(e){e.exports=JSON.parse("{}")}}]);